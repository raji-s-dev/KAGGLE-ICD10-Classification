


new model training cmds

# Seed 42
python train_mlp_upgraded.py `
  --data-dir "D:/Kaggle - Copy - Copy - Copy/preprocessed" `
  --out-dir "D:/Kaggle - Copy - Copy - Copy/outputs/mlp_v1/seed_42" `
  --seed 42 `
  --epochs 30 `
  --batch-size 512

# Seed 123
python train_mlp_upgraded.py `
  --data-dir "D:/Kaggle - Copy - Copy - Copy/preprocessed" `
  --out-dir "D:/Kaggle - Copy - Copy - Copy/outputs/mlp_v1/seed_123" `
  --seed 123 `
  --epochs 30 `
  --batch-size 512

# Seed 2025
python train_mlp_upgraded.py `
  --data-dir "D:/Kaggle - Copy - Copy - Copy/preprocessed" `
  --out-dir "D:/Kaggle - Copy - Copy - Copy/outputs/mlp_v1/seed_2025" `
  --seed 2025 `
  --epochs 30 `
  --batch-size 512

# seed 777
python train_mlp_upgraded.py `
  --data-dir "D:/Kaggle - Copy - Copy - Copy/preprocessed" `
  --out-dir "D:/Kaggle - Copy - Copy - Copy/outputs/mlp_v1/seed_777" `
  --seed 777 `
  --epochs 30 `
  --batch-size 512













ðŸ“Œ So youâ€™ll do this 5 times, once per seed:

ðŸ”§ Seed 42

python optimize_thresholds.py `
  --X-val "../outputs/mlp_v1/seed_42/splits_scaled/X_val.npy" `
  --Y-val "../outputs/mlp_v1/seed_42/splits_scaled/Y_val.npy" `
  --model-path "../outputs/mlp_v1/seed_42/best_mlp.pt" `
  --scaler-path "../outputs/mlp_v1/seed_42/splits_scaled/scaler.json" `
  --out-dir "../outputs/mlp_v1/seed_42/thresholds_greedy" `
  --mode greedy `
  --init-threshold 0.65 `
  --grid-start 0.30 --grid-end 0.70 --grid-steps 41 `
  --max-iters 3 `
  --batch-size 512


ðŸ”§ Seed 123

python optimize_thresholds.py `
  --X-val "../outputs/mlp_v1/seed_123/splits_scaled/X_val.npy" `
  --Y-val "../outputs/mlp_v1/seed_123/splits_scaled/Y_val.npy" `
  --model-path "../outputs/mlp_v1/seed_123/best_mlp.pt" `
  --scaler-path "../outputs/mlp_v1/seed_123/splits_scaled/scaler.json" `
  --out-dir "../outputs/mlp_v1/seed_123/thresholds_greedy" `
  --mode greedy `
  --init-threshold 0.65 `
  --grid-start 0.30 --grid-end 0.70 --grid-steps 41 `
  --max-iters 3 `
  --batch-size 512


ðŸ”§ Seed 2025

python optimize_thresholds.py `
  --X-val "../outputs/mlp_v1/seed_2025/splits_scaled/X_val.npy" `
  --Y-val "../outputs/mlp_v1/seed_2025/splits_scaled/Y_val.npy" `
  --model-path "../outputs/mlp_v1/seed_2025/best_mlp.pt" `
  --scaler-path "../outputs/mlp_v1/seed_2025/splits_scaled/scaler.json" `
  --out-dir "../outputs/mlp_v1/seed_2025/thresholds_greedy" `
  --mode greedy `
  --init-threshold 0.65 `
  --grid-start 0.30 --grid-end 0.70 --grid-steps 41 `
  --max-iters 3 `
  --batch-size 512


ðŸ”§ Seed 777

python optimize_thresholds.py `
  --X-val "../outputs/mlp_v1/seed_777/splits_scaled/X_val.npy" `
  --Y-val "../outputs/mlp_v1/seed_777/splits_scaled/Y_val.npy" `
  --model-path "../outputs/mlp_v1/seed_777/best_mlp.pt" `
  --scaler-path "../outputs/mlp_v1/seed_777/splits_scaled/scaler.json" `
  --out-dir "../outputs/mlp_v1/seed_777/thresholds_greedy" `
  --mode greedy `
  --init-threshold 0.65 `
  --grid-start 0.30 --grid-end 0.70 --grid-steps 41 `
  --max-iters 3 `
  --batch-size 512


ðŸ”§ Seed 999

python optimize_thresholds.py `
  --X-val "../outputs/mlp_v1/seed_999/splits_scaled/X_val.npy" `
  --Y-val "../outputs/mlp_v1/seed_999/splits_scaled/Y_val.npy" `
  --model-path "../outputs/mlp_v1/seed_999/best_mlp.pt" `
  --scaler-path "../outputs/mlp_v1/seed_999/splits_scaled/scaler.json" `
  --out-dir "../outputs/mlp_v1/seed_999/thresholds_greedy" `
  --mode greedy `
  --init-threshold 0.65 `
  --grid-start 0.30 --grid-end 0.70 --grid-steps 41 `
  --max-iters 3 `
  --batch-size 512










here 

python threshold_blender.py







testing all upgraded model with blend threshold 

Seed 42
python test_mlp_upgraded.py `
  --test-path "../data/test_data.npy" `
  --codes-path "../data/cleaned_unique_icd10_codes.txt" `
  --model-path "../outputs/mlp_v1/seed_42/best_mlp.pt" `
  --scaler-path "../outputs/mlp_v1/seed_42/splits_scaled/scaler.json" `
  --thresholds-path "../outputs/mlp_v1/seed_42/thresholds_greedy/thresholds_blend.npy" `
  --out-csv "../outputs/mlp_v1/seed_42/blendpred_seed_42.csv"

Seed 123
python test_mlp_upgraded.py `
  --test-path "../data/test_data.npy" `
  --codes-path "../data/cleaned_unique_icd10_codes.txt" `
  --model-path "../outputs/mlp_v1/seed_123/best_mlp.pt" `
  --scaler-path "../outputs/mlp_v1/seed_123/splits_scaled/scaler.json" `
  --thresholds-path "../outputs/mlp_v1/seed_123/thresholds_greedy/thresholds_blend.npy" `
  --out-csv "../outputs/mlp_v1/seed_123/blendpred_seed_123.csv"

Seed 2025
python test_mlp_upgraded.py `
  --test-path "../data/test_data.npy" `
  --codes-path "../data/cleaned_unique_icd10_codes.txt" `
  --model-path "../outputs/mlp_v1/seed_2025/best_mlp.pt" `
  --scaler-path "../outputs/mlp_v1/seed_2025/splits_scaled/scaler.json" `
  --thresholds-path "../outputs/mlp_v1/seed_2025/thresholds_greedy/thresholds_blend.npy" `
  --out-csv "../outputs/mlp_v1/seed_2025/blendpred_seed_2025.csv"

Seed 777
python test_mlp_upgraded.py `
  --test-path "../data/test_data.npy" `
  --codes-path "../data/cleaned_unique_icd10_codes.txt" `
  --model-path "../outputs/mlp_v1/seed_777/best_mlp.pt" `
  --scaler-path "../outputs/mlp_v1/seed_777/splits_scaled/scaler.json" `
  --thresholds-path "../outputs/mlp_v1/seed_777/thresholds_greedy/thresholds_blend.npy" `
  --out-csv "../outputs/mlp_v1/seed_777/blendpred_seed_777.csv"

Seed 999
python test_mlp_upgraded.py `
  --test-path "../data/test_data.npy" `
  --codes-path "../data/cleaned_unique_icd10_codes.txt" `
  --model-path "../outputs/mlp_v1/seed_999/best_mlp.pt" `
  --scaler-path "../outputs/mlp_v1/seed_999/splits_scaled/scaler.json" `
  --thresholds-path "../outputs/mlp_v1/seed_999/thresholds_greedy/thresholds_blend.npy" `
  --out-csv "../outputs/mlp_v1/seed_999/blendpred_seed_999.csv"


last
python generate_submission.py